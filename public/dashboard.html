<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>لوحة الإدارة - منصة أشير</title>

<style>
body{
font-family:Arial;
background:#0f172a;
color:white;
padding:20px;
}

h1{
color:#22c55e;
}

table{
width:100%;
border-collapse:collapse;
background:#1e293b;
border-radius:10px;
overflow:hidden;
}

th,td{
padding:10px;
border-bottom:1px solid #334155;
text-align:center;
}

button{
padding:6px 12px;
border:none;
border-radius:6px;
cursor:pointer;
}

.delete{
background:#ef4444;
color:white;
}

.whatsapp{
background:#22c55e;
color:white;
}
</style>

</head>
<body>

<h1>لوحة إدارة منصة أشير</h1>

<p>عدد الطلبات: <span id="count">0</span></p>

<table>
<thead>
<tr>
<th>الوقت</th>
<th>الاسم</th>
<th>الهاتف</th>
<th>الخدمة</th>
<th>ملاحظة</th>
<th>واتساب</th>
<th>حذف</th>
</tr>
</thead>

<tbody id="orders"></tbody>

</table>

<script>

async function load(){

const res = await fetch("/api/orders");
const data = await res.json();

document.getElementById("count").innerText = data.length;

let html="";

data.reverse().forEach(o=>{

html+=`
<tr>

<td>${new Date(o.date).toLocaleString()}</td>

<td>${o.name}</td>

<td>${o.phone}</td>

<td>${o.service}</td>

<td>${o.note||""}</td>

<td>
<a href="https://wa.me/${o.phone}" target="_blank">
<button class="whatsapp">فتح</button>
</a>
</td>

<td>
<button class="delete"
onclick="remove('${o.id}')">
حذف
</button>
</td>

</tr>
`;

});

document.getElementById("orders").innerHTML=html;

}

async function remove(id){

await fetch("/api/orders/"+id,{
method:"DELETE"
});

load();

}

load();

setInterval(load,3000);

</script>

</body>
</html>
